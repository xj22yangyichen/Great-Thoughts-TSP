# Great-Thoughts-TSP

这是 2025 学年第一学期计算机科学的伟大思想课程 presentation 的代码仓库，presentation 的主题是 P vs NP —— 以 TSP 问题为例。

## 简介

TSP（旅行商）问题指的是在一张图上，从起点 S 不重复地遍历图上的所有节点，最后回到 S，求最短路径。

为帮助同学们理解 NP 问题，以 TSP 问题为例，提供一些参考实现，包括暴力方法、Held-Karp 算法、启发式算法——以模拟退火法为例。

复杂度分析中的 $n$ 指节点数。

以下的“运行时间”中的“小规模数据”指的是在 $N=15$，$T=1000$ 时代码运行所需的时间；“大规模数据”指的是在 $N=100$，$T=1000$ 时代码运行所需的时间。

## 暴力方法

### 实现思路

枚举所有可能的路径。

### 复杂度分析

总共有 $n!$ 种路径，计算每条路径长度的时间复杂度为 $O(n)$，总时间复杂度为 $O(n \times (n!))$。

### 运行时间

#### 小规模数据

$1873872s$

#### 大规模数据

大约 $10^{144}$ 年

## Held-Karp

### 实现思路

Held_Karp 算法本质上是状压 DP，用 $DP[S][i]$ 表示已经访问过的节点集合为 $S$，最后位于节点 $i$ 的最短路径长度。状态转移方程为：

$$
dp[S][i] = \min_{j \in S \setminus i} \{dp[S \setminus i][j] + dis[j][i]\}
$$

### 复杂度分析

$dp$ 数组的每个状态的计算需要 $O(n)$ 的时间，总复杂度 $O(n^2 \cdot 2^n)$ 

### 运行时间

#### 小规模数据

$51.95s$

#### 大规模数据

大约 $10^{16}$ 年

## 模拟退火

### 实现思路

模拟退火（Simulated Annealing, SA）是一种随机优化算法，灵感来自金属退火过程。其核心思想是通过在高温下随机探索，并逐步降低“温度”参数，从而平衡“探索”与“利用”，最终收敛到全局最优或近似最优解。

**基本思想：**

- 初始解从整个解空间随机选取；
- 在每一步，从当前解的邻域中随机选择新解；
- 若新解更优则直接接受，否则以一定概率接受劣解：
  $$
  P(\text{accept}) = \exp\left(-\frac{\Delta f}{T}\right)
  $$
- 温度逐步下降，直到接近零。

**主要特点：**

- 能跳出局部最优；
- 可用于连续或离散优化；
- 运行时间取决于降温速度与邻域设计。

而 TSP 问题完全符合模拟退火算法的条件。

### 复杂度分析

设降温次数为 $M$，每个温度下的迭代次数为 $L$，每次操作的时间复杂度为 $O(n)$，则总时间复杂度为 $O(MLn)$。

### 运行时间

#### 小规模数据

$55.68s$

#### 大规模数据

$68.81s$

### 准确率

$99\%$ 以上